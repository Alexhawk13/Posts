"use strict";(self["webpackChunkvue_trainee"]=self["webpackChunkvue_trainee"]||[]).push([[339],{1384:function(e,t,o){var i=o(9269),s=o(4633),a=o(8108),l=o(6597),n=o(505),r=o(3856),c=o(3027),d=o(64);const u={xs:8,sm:10,md:14,lg:20,xl:24};t["Z"]=(0,r.L)({name:"QChip",props:{...l.S,...n.LU,dense:Boolean,icon:String,iconRight:String,iconRemove:String,iconSelected:String,label:[String,Number],color:String,textColor:String,modelValue:{type:Boolean,default:!0},selected:{type:Boolean,default:null},square:Boolean,outline:Boolean,clickable:Boolean,removable:Boolean,tabindex:[String,Number],disable:Boolean,ripple:{type:[Boolean,Object],default:!0}},emits:["update:modelValue","update:selected","remove","click"],setup(e,{slots:t,emit:o}){const{proxy:{$q:r}}=(0,i.FN)(),m=(0,l.Z)(e,r),p=(0,n.ZP)(e,u),h=(0,i.Fl)((()=>!0===e.selected||void 0!==e.icon)),g=(0,i.Fl)((()=>!0===e.selected?e.iconSelected||r.iconSet.chip.selected:e.icon)),f=(0,i.Fl)((()=>e.iconRemove||r.iconSet.chip.remove)),v=(0,i.Fl)((()=>!1===e.disable&&(!0===e.clickable||null!==e.selected))),_=(0,i.Fl)((()=>{const t=!0===e.outline&&e.color||e.textColor;return"q-chip row inline no-wrap items-center"+(!1===e.outline&&void 0!==e.color?` bg-${e.color}`:"")+(t?` text-${t} q-chip--colored`:"")+(!0===e.disable?" disabled":"")+(!0===e.dense?" q-chip--dense":"")+(!0===e.outline?" q-chip--outline":"")+(!0===e.selected?" q-chip--selected":"")+(!0===v.value?" q-chip--clickable cursor-pointer non-selectable q-hoverable":"")+(!0===e.square?" q-chip--square":"")+(!0===m.value?" q-chip--dark q-dark":"")})),w=(0,i.Fl)((()=>!0===e.disable?{tabindex:-1,"aria-disabled":"true"}:{tabindex:e.tabindex||0}));function b(e){13===e.keyCode&&y(e)}function y(t){e.disable||(o("update:selected",!e.selected),o("click",t))}function C(t){void 0!==t.keyCode&&13!==t.keyCode||((0,c.NS)(t),!1===e.disable&&(o("update:modelValue",!1),o("remove")))}function k(){const o=[];!0===v.value&&o.push((0,i.h)("div",{class:"q-focus-helper"})),!0===h.value&&o.push((0,i.h)(s.Z,{class:"q-chip__icon q-chip__icon--left",name:g.value}));const a=void 0!==e.label?[(0,i.h)("div",{class:"ellipsis"},[e.label])]:void 0;return o.push((0,i.h)("div",{class:"q-chip__content col row no-wrap items-center q-anchor--skip"},(0,d.pf)(t.default,a))),e.iconRight&&o.push((0,i.h)(s.Z,{class:"q-chip__icon q-chip__icon--right",name:e.iconRight})),!0===e.removable&&o.push((0,i.h)(s.Z,{class:"q-chip__icon q-chip__icon--remove cursor-pointer",name:f.value,...w.value,onClick:C,onKeyup:C})),o}return()=>{if(!1===e.modelValue)return;const t={class:_.value,style:p.value};return!0===v.value&&Object.assign(t,w.value,{onClick:y,onKeyup:b}),(0,d.Jl)("div",t,k(),"ripple",!1!==e.ripple&&!0!==e.disable,(()=>[[a.Z,e.ripple]]))}}})},2537:function(e,t,o){var i=o(9269),s=o(6237),a=o(1384),l=o(5093),n=o(9724),r=o(5182),c=o(9976),d=o(3856),u=o(7328),m=o(3027);t["Z"]=(0,d.L)({name:"QFile",inheritAttrs:!1,props:{...l.Cl,...n.Fz,...r.TS,modelValue:[File,FileList,Array],append:Boolean,useChips:Boolean,displayValue:[String,Number],tabindex:{type:[String,Number],default:0},counterLabel:Function,inputClass:[Array,String,Object],inputStyle:[Array,String,Object]},emits:[...l.HJ,...r.Pl],setup(e,{slots:t,emit:o,attrs:d}){const{proxy:p}=(0,i.FN)(),h=(0,l.tL)(),g=(0,s.iH)(null),f=(0,s.iH)(!1),v=(0,n.Do)(e),{pickFiles:_,onDragover:w,onDragleave:b,processFiles:y,getDndNode:C}=(0,r.ZP)({editable:h.editable,dnd:f,getFileInput:E,addFilesToQueue:W}),k=(0,c.Z)(e),x=(0,i.Fl)((()=>Object(e.modelValue)===e.modelValue?"length"in e.modelValue?Array.from(e.modelValue):[e.modelValue]:[])),q=(0,i.Fl)((()=>(0,l.yV)(x.value))),D=(0,i.Fl)((()=>x.value.map((e=>e.name)).join(", "))),F=(0,i.Fl)((()=>(0,u.rB)(x.value.reduce(((e,t)=>e+t.size),0)))),V=(0,i.Fl)((()=>({totalSize:F.value,filesNumber:x.value.length,maxFiles:e.maxFiles}))),$=(0,i.Fl)((()=>({tabindex:-1,type:"file",title:"",accept:e.accept,capture:e.capture,name:v.value,...d,id:h.targetUid.value,disabled:!0!==h.editable.value}))),L=(0,i.Fl)((()=>!0===e.multiple&&!0===e.append));function S(e){const t=x.value.slice();t.splice(e,1),U(t)}function Z(e){const t=x.value.findIndex(e);t>-1&&S(t)}function U(t){o("update:modelValue",!0===e.multiple?t:t[0])}function A(e){13===e.keyCode&&(0,m.X$)(e)}function j(e){13!==e.keyCode&&32!==e.keyCode||_(e)}function E(){return g.value}function W(t,o){const i=y(t,o,x.value,L.value);void 0!==i&&((!0===e.multiple?e.modelValue&&i.every((e=>x.value.includes(e))):e.modelValue===i[0])||U(!0===L.value?x.value.concat(i):i))}function I(){return[(0,i.h)("input",{class:[e.inputClass,"q-file__filler"],style:e.inputStyle})]}function z(){if(void 0!==t.file)return 0===x.value.length?I():x.value.map(((e,o)=>t.file({index:o,file:e,ref:this})));if(void 0!==t.selected)return 0===x.value.length?I():t.selected({files:x.value,ref:this});if(!0===e.useChips)return 0===x.value.length?I():x.value.map(((t,o)=>(0,i.h)(a.Z,{key:"file-"+o,removable:h.editable.value,dense:!0,textColor:e.color,tabindex:e.tabindex,onRemove:()=>{S(o)}},(()=>(0,i.h)("span",{class:"ellipsis",textContent:t.name})))));const o=void 0!==e.displayValue?e.displayValue:D.value;return o.length>0?[(0,i.h)("div",{class:e.inputClass,style:e.inputStyle,textContent:o})]:I()}function B(){const t={ref:g,...$.value,...k.value,class:"q-field__input fit absolute-full cursor-pointer",onChange:W};return!0===e.multiple&&(t.multiple=!0),(0,i.h)("input",t)}return Object.assign(h,{fieldClass:{value:"q-file q-field--auto-height"},emitValue:U,hasValue:q,inputRef:g,innerValue:x,floatingLabel:(0,i.Fl)((()=>!0===q.value||(0,l.yV)(e.displayValue))),computedCounter:(0,i.Fl)((()=>{if(void 0!==e.counterLabel)return e.counterLabel(V.value);const t=e.maxFiles;return`${x.value.length}${void 0!==t?" / "+t:""} (${F.value})`})),getControlChild:()=>C("file"),getControl:()=>{const t={ref:h.targetRef,class:"q-field__native row items-center cursor-pointer",tabindex:e.tabindex};return!0===h.editable.value&&Object.assign(t,{onDragover:w,onDragleave:b,onKeydown:A,onKeyup:j}),(0,i.h)("div",t,[B()].concat(z()))}}),Object.assign(p,{removeAtIndex:S,removeFile:Z,getNativeElement:()=>g.value}),(0,l.ZP)(h)}})},3276:function(e,t,o){var i=o(9269),s=o(6237),a=o(3856),l=o(3027),n=o(6146),r=o(64),c=o(4300);t["Z"]=(0,a.L)({name:"QForm",props:{autofocus:Boolean,noErrorFocus:Boolean,noResetFocus:Boolean,greedy:Boolean,onSubmit:Function},emits:["reset","validation-success","validation-error"],setup(e,{slots:t,emit:o}){const a=(0,i.FN)(),d=(0,s.iH)(null);let u=0;const m=[];function p(t){const i=[],s="boolean"===typeof t?t:!0!==e.noErrorFocus,a=++u,l=(e,t)=>{o("validation-"+(!0===e?"success":"error"),t)};for(let o=0;o<m.length;o++){const t=m[o],a=t.validate();if("function"===typeof a.then)i.push(a.then((e=>({valid:e,comp:t})),(e=>({valid:!1,comp:t,err:e}))));else if(!0!==a){if(!1===e.greedy)return l(!1,t),!0===s&&"function"===typeof t.focus&&t.focus(),Promise.resolve(!1);i.push({valid:!1,comp:t})}}return 0===i.length?(l(!0),Promise.resolve(!0)):Promise.all(i).then((e=>{const t=e.filter((e=>!0!==e.valid));if(0===t.length)return a===u&&l(!0),!0;const{valid:o,comp:i,err:n}=t[0];return a===u&&(void 0!==n&&console.error(n),l(!1,i),!0===s&&!0!==o&&"function"===typeof i.focus&&i.focus()),!1}))}function h(){u++,m.forEach((e=>{"function"===typeof e.resetValidation&&e.resetValidation()}))}function g(t){void 0!==t&&(0,l.NS)(t);const i=u+1;p().then((s=>{i===u&&!0===s&&(void 0!==e.onSubmit?o("submit",t):void 0!==t&&void 0!==t.target&&"function"===typeof t.target.submit&&t.target.submit())}))}function f(t){void 0!==t&&(0,l.NS)(t),o("reset"),(0,i.Y3)((()=>{h(),!0===e.autofocus&&!0!==e.noResetFocus&&v()}))}function v(){(0,n.jd)((()=>{if(null===d.value)return;const e=d.value.querySelector("[autofocus], [data-autofocus]")||Array.prototype.find.call(d.value.querySelectorAll("[tabindex]"),(e=>e.tabIndex>-1));null!==e&&void 0!==e&&e.focus({preventScroll:!0})}))}(0,i.JJ)(c.vh,{bindComponent(e){m.push(e)},unbindComponent(e){const t=m.indexOf(e);t>-1&&m.splice(t,1)}});let _=!1;return(0,i.se)((()=>{_=!0})),(0,i.dl)((()=>{!0===_&&!0===e.autofocus&&v()})),(0,i.bv)((()=>{!0===e.autofocus&&v()})),Object.assign(a.proxy,{validate:p,resetValidation:h,submit:g,reset:f,focus:v,getValidationComponents:()=>m}),()=>(0,i.h)("form",{class:"q-form",ref:d,onSubmit:g,onReset:f},(0,r.KR)(t.default))}})},4248:function(e,t,o){o.d(t,{L:function(){return s}});var i=o(6679);function s(e,t){i.Z.create({dark:!0,message:`Are you sure to delete this ${e} `,persistent:!0,class:"text-h6 text-center",ok:{push:!0,color:"negative",label:"Delete",padding:"7px 40px",class:"q-mr-auto"},cancel:{push:!0,color:"primary",label:"Cancel",padding:"7px 40px",class:"q-ml-auto"}}).onOk((()=>{t()})).onCancel((()=>{}))}},2339:function(e,t,o){o.r(t),o.d(t,{default:function(){return Ze}});var i=o(9269);function s(e,t,o,s,a,l){const n=(0,i.up)("PostDetails"),r=(0,i.up)("CommentBlock");return(0,i.wg)(),(0,i.iD)(i.HY,null,[a.isLoading?(0,i.kq)("",!0):((0,i.wg)(),(0,i.j4)(n,{key:0,onEditMode:t[0]||(t[0]=e=>a.isEditing=!a.isEditing),onShowAllComments:t[1]||(t[1]=e=>a.showAllComments=!a.showAllComments),post:e.getDetailsPost,comments:e.getComments},null,8,["post","comments"])),a.isEditing||a.isLoading?(0,i.kq)("",!0):((0,i.wg)(),(0,i.j4)(r,{key:1,showAllComments:a.showAllComments},null,8,["showAllComments"]))],64)}var a=o(3201);const l=e=>((0,i.dD)("data-v-b73987f2"),e=e(),(0,i.Cn)(),e),n={key:0,class:"q-py-lg q-px-md card-wrapper"},r={class:"card__settings-wrapper"},c={class:"date-block"},d=l((()=>(0,i._)("br",null,null,-1))),u=["src"],m={class:"card__title"},p={class:"card__description"},h={class:"card__description"},g=["src"],f={class:"q-pl-sm q-mb-none card__footer__author__name"},v={key:1,class:"flex column justify-center card__update"},_=["src"],w=(0,i.Uk)(" Upload image for this post "),b=(0,i.Uk)("Update");function y(e,t,o,s,l,y){const C=(0,i.up)("q-btn"),k=(0,i.up)("q-card-section"),x=(0,i.up)("q-icon"),q=(0,i.up)("q-avatar"),D=(0,i.up)("q-card"),F=(0,i.up)("q-file"),V=(0,i.up)("q-input");return l.isEditing?((0,i.wg)(),(0,i.iD)("div",v,[this.post.image||this.imgFile?((0,i.wg)(),(0,i.iD)("img",{key:0,class:"block q-mx-auto card__update__image",src:l.image},null,8,_)):(0,i.kq)("",!0),(0,i.Wm)(F,{class:"uploader cursor-pointer",accept:".jpg, .png, webP, image/*",filled:"",modelValue:l.imgFile,"onUpdate:modelValue":[t[3]||(t[3]=e=>l.imgFile=e),y.handleUpload]},{default:(0,i.w5)((()=>[w])),_:1},8,["modelValue","onUpdate:modelValue"]),(0,i.Wm)(D,{class:"text-center"},{default:(0,i.w5)((()=>[(0,i.Wm)(k,null,{default:(0,i.w5)((()=>[(0,i.Wm)(V,{autogrow:"",class:"title",modelValue:l.title,"onUpdate:modelValue":t[4]||(t[4]=e=>l.title=e),label:"Title"},null,8,["modelValue"])])),_:1}),(0,i.Wm)(k,{class:"q-pt-none"},{default:(0,i.w5)((()=>[(0,i.Wm)(V,{autogrow:"",class:"description",modelValue:l.description,"onUpdate:modelValue":t[5]||(t[5]=e=>l.description=e),label:"Description"},null,8,["modelValue"])])),_:1}),(0,i.Wm)(k,{class:"q-pt-none"},{default:(0,i.w5)((()=>[(0,i.Wm)(V,{label:"Post Text",type:"textarea",rows:"10",cols:"33",modelValue:l.fullText,"onUpdate:modelValue":t[6]||(t[6]=e=>l.fullText=e),placeholder:"Post Text"},null,8,["modelValue"])])),_:1})])),_:1}),(0,i.Wm)(C,{class:"self-end q-px-lg q-my-md",color:"primary",onClick:y.updatePost},{default:(0,i.w5)((()=>[b])),_:1},8,["onClick"])])):((0,i.wg)(),(0,i.iD)("div",n,[(0,i.Wm)(D,{class:"card text-center"},{default:(0,i.w5)((()=>[(0,i._)("div",r,[y.isOwnPost?((0,i.wg)(),(0,i.j4)(C,{key:0,onClick:t[0]||(t[0]=t=>{l.isEditing=!l.isEditing,e.$emit("editMode")}),icon:"settings",size:"24px",class:"cursor-pointer card__settings"})):(0,i.kq)("",!0)]),(0,i._)("div",c,[(0,i._)("strong",null,(0,a.zw)(y.date[1]),1),d,(0,i.Uk)(" "+(0,a.zw)(y.date[0]),1)]),(0,i._)("img",{class:"card__image",src:o.post.image?`${l.baseUrl+o.post.image}`:"https://cdn.quasar.dev/img/mountains.jpg"},null,8,u),(0,i.Wm)(k,null,{default:(0,i.w5)((()=>[(0,i._)("p",m,(0,a.zw)(o.post.title),1)])),_:1}),(0,i.Wm)(k,{class:"q-pt-none"},{default:(0,i.w5)((()=>[(0,i._)("p",p,(0,a.zw)(o.post.description),1)])),_:1}),(0,i.Wm)(k,{class:"q-pt-none"},{default:(0,i.w5)((()=>[(0,i._)("p",h,(0,a.zw)(o.post.fullText),1)])),_:1}),(0,i.Wm)(k,{class:"card__footer"},{default:(0,i.w5)((()=>[(0,i._)("div",null,[(0,i.Wm)(C,{round:"",onClick:y.likePost,disabled:l.isLoading},{default:(0,i.w5)((()=>[(0,i.Wm)(x,{name:y.isLiked(o.post)?"favorite":"favorite_border",color:y.isLiked(o.post)?"red":"black",size:"sm",class:"cursor-pointer"},null,8,["name","color"])])),_:1},8,["onClick","disabled"]),(0,i._)("span",null,(0,a.zw)(l.likes.length),1),(0,i._)("span",{class:"card__footer__show-comments q-pl-sm cursor-pointer",onClick:t[1]||(t[1]=t=>e.$emit("showAllComments"))},[(0,i.Wm)(x,{class:"q-pl-md q-mr-sm",size:"sm",name:"message"}),(0,i.Uk)((0,a.zw)(o.comments?o.comments.length:0),1)])]),(0,i._)("div",{onClick:t[2]||(t[2]=(...e)=>y.profileView&&y.profileView(...e)),class:"card__footer__author flex items-center justify-end no-wrap cursor-pointer"},[(0,i.Wm)(q,{class:"card__footer__author__avatar"},{default:(0,i.w5)((()=>[l.author&&l.author.avatar?((0,i.wg)(),(0,i.iD)("img",{key:1,src:`${l.baseUrl+y.authorAvatar()}`},null,8,g)):((0,i.wg)(),(0,i.j4)(x,{key:0,name:"face",size:"40px"}))])),_:1}),(0,i._)("p",f,(0,a.zw)(l.author&&l.author.name?l.author.name:"John Doe"),1)])])),_:1})])),_:1})]))}var C=o(4455),k=o(6957),x=o(6679),q=o(2746),D=o(406);async function F(e,t){let o=t.likes;return D.Z.getters.isAuth?(await D.Z.dispatch(e,t._id),V(t)?o.pop():o.push(D.Z.getters.getUserData._id)):x.Z.create({dark:!0,message:"Only authorized users are allowed to do that",persistent:!0,class:"text-h6 text-center",ok:{push:!0,color:"primary",label:"Log In",padding:"7px 40px",class:"q-mr-auto"},cancel:{push:!0,color:"negative",label:"Dismiss",padding:"7px 40px",class:"q-ml-auto"}}).onOk((()=>{q.Z.push({name:"LogIn"})})).onCancel((()=>{})),o}function V(e){return!!D.Z.getters.getUserData&&e.likes.includes(D.Z.getters.getUserData._id)}var $={name:"PostDetails",props:{post:{type:Object,default:()=>{}},comments:{type:Object,default:()=>{}}},data(){return{author:null,isEditing:!1,baseUrl:"http://test-blog-api.ficuslife.com",isLoading:!1,showAllComments:!1,likes:this.post.likes,title:this.post.title,description:this.post.description,fullText:this.post.fullText,imgFile:null,sendImgFile:null,image:this.post.image}},async mounted(){this.post.image&&(this.image=this.baseUrl+this.post.image);let e=this.post?this.post.postedBy:"";e&&(this.author=await this.$store.dispatch("fetchAuthor",e))},methods:{isLiked:V,authorAvatar(){if(this.author&&this.author.avatar)return this.author.avatar},async likePost(){this.isLoading=!0,this.likes=await F("postLike",this.post),this.isLoading=!1},profileView(){this.author&&this.$router.push({name:"AuthorView",params:{id:this.author._id}})},handleUpload(){this.sendImgFile=this.imgFile,this.image=URL.createObjectURL(this.imgFile)},async updatePost(){if(this.sendImgFile){const e=new FormData;e.append("image",this.sendImgFile);const t={id:this.post._id,img:e};await this.$store.dispatch("updatePostImage",t)}const e=["title","description","fullText"],t=e.filter((e=>this[e]!==this.post[e])),o={};for(let s of t)o[s]=this[s];const i={obj:o,id:this.post._id};Object.keys(o).length&&this.$store.dispatch("updatePost",i),this.isEditing=!1}},computed:{...(0,k.Se)(["getUserData","isAuth"]),date(){return this.post&&this.post.dateCreated?(0,C.pJ)(this.post.dateCreated).split(" "):""},isOwnPost(){return!!this.getUserData&&this.getUserData._id===this.post.postedBy}}},L=o(7617),S=o(8055),Z=o(9804),U=o(9501),A=o(4633),j=o(9393),E=o(2537),W=o(6053),I=o(1410),z=o.n(I);const B=(0,L.Z)($,[["render",y],["__scopeId","data-v-b73987f2"]]);var P=B;z()($,"components",{QCard:S.Z,QBtn:Z.Z,QCardSection:U.Z,QIcon:A.Z,QAvatar:j.Z,QFile:E.Z,QInput:W.Z});var O=o(5102);const R={key:0},Q={key:1,class:"text-center"},T=(0,i.Uk)(" To leave a comment you should "),N=(0,i._)("strong",null," Log In",-1),J=(0,i.Uk)(" first "),K={key:2},H={key:0,class:"text-center text-bold q-pb-lg"};function M(e,t,o,s,a,l){const n=(0,i.up)("AddComment"),r=(0,i.up)("router-link"),c=(0,i.up)("CommentCard");return(0,i.wg)(),(0,i.iD)(i.HY,null,[e.isAuth?((0,i.wg)(),(0,i.iD)("div",R,[(0,i.Wm)(n,{post:a.post},null,8,["post"])])):((0,i.wg)(),(0,i.iD)("div",Q,[T,(0,i.Wm)(r,{to:{name:"LogIn"}},{default:(0,i.w5)((()=>[N])),_:1}),J])),a.isLoading?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("div",K,[(0,i._)("div",null,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(l.createCommentsTree,(e=>(0,i.wy)(((0,i.wg)(),(0,i.j4)(c,{key:e.id,comment:e},null,8,["comment"])),[[O.F8,o.showAllComments]]))),128))]),e.getComments.length?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("div",H," There are no comments yet "))]))],64)}const Y={class:"comment row no-wrap items-start full-height q-mb-md q-px-none"},X=["src"],G={class:"no-wrap full-width"},ee={key:0},te={class:"comment__text q-pa-sm text-body1"},oe={class:"comment__text__author text-bold full-width"},ie={class:"row items-center justify-between q-py-md"},se={class:"reply text-bold row cursor-pointer"},ae={key:0,class:"q-pl-md"},le={class:"likes-wrapper text-right"},ne={class:"q-pr-lg"},re={key:1},ce={class:"comment__text"},de={class:"comment__text__author text-bold q-px-sm q-mb-none"},ue={class:"text-bold cursor-pointer"},me={key:0};function pe(e,t,o,s,l,n){const r=(0,i.up)("q-icon"),c=(0,i.up)("q-avatar"),d=(0,i.up)("q-btn"),u=(0,i.up)("q-input"),m=(0,i.up)("CommentCard",!0),p=(0,i.up)("AddComment"),h=(0,i.up)("q-card-section");return(0,i.wg)(),(0,i.j4)(h,{class:"q-pa-none"},{default:(0,i.w5)((()=>[(0,i._)("div",Y,[(0,i.Wm)(c,{onClick:n.profileView,class:"cursor-pointer q-mr-sm"},{default:(0,i.w5)((()=>[l.author&&l.author.avatar?((0,i.wg)(),(0,i.iD)("img",{key:1,class:"avatar comment__avatar",src:`${l.baseUrl+n.authorAvatar()}`},null,8,X)):((0,i.wg)(),(0,i.j4)(r,{key:0,class:"avatar comment__avatar",name:"face",size:"40px"}))])),_:1},8,["onClick"]),(0,i._)("div",G,[l.isEditable?((0,i.wg)(),(0,i.iD)("div",re,[(0,i._)("div",ce,[(0,i._)("p",de,(0,a.zw)(l.author?l.author.name:"John Doe"),1),(0,i.Wm)(u,{onKeydown:(0,O.D2)((0,O.iM)(n.editComment,["prevent"]),["enter"]),modelValue:l.textEdit,"onUpdate:modelValue":t[3]||(t[3]=e=>l.textEdit=e),autogrow:"",type:"text",class:"q-px-sm text-bold",error:l.v$.textEdit.$error,"error-message":l.v$.textEdit.$errors[0]?.$message},null,8,["onKeydown","modelValue","error","error-message"])]),(0,i._)("footer",ue,[(0,i._)("span",{class:"q-pr-lg",onClick:t[4]||(t[4]=(...e)=>n.editComment&&n.editComment(...e))},"save changes"),(0,i._)("span",{onClick:t[5]||(t[5]=(...e)=>n.cancelEdit&&n.cancelEdit(...e))},"cancel")])])):((0,i.wg)(),(0,i.iD)("div",ee,[(0,i._)("div",te,[(0,i._)("p",oe,(0,a.zw)(l.author?l.author.name:"John Doe"),1),(0,i._)("p",null,(0,a.zw)(o.comment?o.comment.text:""),1)]),(0,i._)("footer",ie,[(0,i._)("div",se,[(0,i._)("span",{onClick:t[0]||(t[0]=e=>(l.reply=!0,l.isChildShown=!0))},"reply"),n.isMyComment?((0,i.wg)(),(0,i.iD)("div",ae,[(0,i._)("span",{onClick:t[1]||(t[1]=e=>l.isEditable=!0)},"edit"),(0,i._)("span",{onClick:t[2]||(t[2]=(...e)=>n.deleteComment&&n.deleteComment(...e)),class:"q-pl-md"},"delete")])):(0,i.kq)("",!0)]),(0,i._)("div",le,[(0,i._)("span",ne,(0,a.zw)(n.date),1),(0,i.Wm)(d,{round:"",class:"no-box-shadow",onClick:n.likeComment,disabled:l.isLoading},{default:(0,i.w5)((()=>[(0,i.Wm)(r,{name:n.isLiked(o.comment)?"favorite":"favorite_border",color:n.isLiked(o.comment)?"red":"black",size:"sm",class:"likes"},null,8,["name","color"])])),_:1},8,["onClick","disabled"]),(0,i._)("span",null,(0,a.zw)(l.likes.length),1)])])])),n.hasChildren?((0,i.wg)(),(0,i.iD)("div",{key:2,class:"replies text-bold no-box-shadow q-pa-none cursor-pointer",onClick:t[6]||(t[6]=e=>l.isChildShown=!l.isChildShown)},[(0,i._)("span",null,(0,a.zw)(o.comment.children.length)+" "+(0,a.zw)(o.comment.children.length>1?"Replies":"Reply"),1),(0,i.Wm)(r,{name:l.isChildShown?"arrow_drop_down":"arrow_right",size:"sm"},null,8,["name"])])):(0,i.kq)("",!0)])]),(0,i.wy)((0,i._)("div",null,[n.hasChildren?((0,i.wg)(),(0,i.iD)("div",me,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(o.comment.children,(e=>((0,i.wg)(),(0,i.j4)(m,{key:e._id,comment:e,class:"q-pl-xl"},null,8,["comment"])))),128))])):(0,i.kq)("",!0)],512),[[O.F8,n.showReply]]),(0,i.wy)((0,i.Wm)(p,{onReplied:t[7]||(t[7]=e=>l.reply=!1),comment:o.comment},null,8,["comment"]),[[O.F8,l.reply]])])),_:1})}const he=["src"];function ge(e,t,o,s,a,l){const n=(0,i.up)("q-icon"),r=(0,i.up)("q-avatar"),c=(0,i.up)("q-input"),d=(0,i.up)("q-form");return(0,i.wg)(),(0,i.j4)(d,{class:"comment-form q-pb-lg row no-wrap"},{default:(0,i.w5)((()=>[(0,i.Wm)(r,null,{default:(0,i.w5)((()=>[e.getUserData&&e.getUserData.avatar?((0,i.wg)(),(0,i.iD)("img",{key:1,src:`${a.baseUrl+e.getUserData.avatar}`},null,8,he)):((0,i.wg)(),(0,i.j4)(n,{key:0,size:"lg",name:"face"}))])),_:1}),(0,i.Wm)(c,{onKeydown:(0,O.D2)((0,O.iM)(l.createComment,["prevent"]),["enter"]),"bg-color":"grey-1",type:"text",autogrow:"",rounded:"",outlined:"",class:"comment-form__message full-width",modelValue:a.text,"onUpdate:modelValue":t[0]||(t[0]=e=>a.text=e),placeholder:"Write a comment",error:a.v$.text.$error,"error-message":a.v$.text.$errors[0]?.$message},{default:(0,i.w5)((()=>[(0,i.Wm)(r,{onClick:l.createComment},{default:(0,i.w5)((()=>[(0,i.Wm)(n,{name:"send"})])),_:1},8,["onClick"])])),_:1},8,["onKeydown","modelValue","error","error-message"])])),_:1})}var fe=o(5261),ve=o(7949),_e={props:{post:{type:Object,default:()=>{}},comment:{type:Object,default:()=>{}}},data(){return{text:"",baseUrl:"http://test-blog-api.ficuslife.com",v$:(0,fe.ZP)()}},validations(){return{text:{required:ve.C1,minLength:(0,ve.Ei)(3)}}},methods:{async createComment(){if(this.v$.$invalid)this.v$.$touch();else if(this.isAuth){let e={};e=this.isReplyToComment?{id:this.comment.postID,text:this.text,followedCommentID:this.comment._id}:{id:this.post._id,text:this.text,followedCommentID:null},await this.$store.dispatch("commentCreate",e),this.text="",this.$emit("replied")}else x.Z.create({dark:!0,message:"Only authorized users are allowed to do that",persistent:!0,class:"text-h6 text-center",ok:{push:!0,color:"primary",label:"Log In",padding:"7px 40px",class:"q-mr-auto"},cancel:{push:!0,color:"negative",label:"Dismiss",padding:"7px 40px",class:"q-ml-auto"}}).onOk((()=>{this.$router.push({name:"LogIn"})})).onCancel((()=>{}))}},computed:{...(0,k.Se)(["getUserData","isAuth"]),isReplyToComment(){return this.comment}}},we=o(3276);const be=(0,L.Z)(_e,[["render",ge],["__scopeId","data-v-fc08aeb2"]]);var ye=be;z()(_e,"components",{QForm:we.Z,QAvatar:j.Z,QIcon:A.Z,QInput:W.Z});var Ce=o(4248),ke={name:"CommentsCard",components:{AddComment:ye},props:{comment:{type:Object,default:()=>{}}},data(){return{v$:(0,fe.ZP)(),author:null,baseUrl:"http://test-blog-api.ficuslife.com",likes:this.comment.likes,textEdit:this.comment.text,isLoading:!1,isChildShown:!1,reply:!1,isEditable:!1}},validations(){return{textEdit:{required:ve.C1,minLength:(0,ve.Ei)(3),maxLength:(0,ve.BS)(80)}}},async mounted(){this.comment&&this.comment.commentedBy&&(this.author=await this.$store.dispatch("fetchAuthor",this.comment.commentedBy))},methods:{isLiked:V,dialogDeleteWrapper:Ce.L,authorAvatar(){if(this.author&&this.author.avatar)return this.author.avatar},profileView(){this.$router.push({name:"AuthorView",params:{id:this.author._id}})},async likeComment(){this.isLoading=!0,this.likes=await F("commentLike",this.comment),this.isLoading=!1},editComment(){if(this.v$.textEdit.$invalid)return void this.v$.$touch();const e=this.textEdit,t={text:e,id:this.comment._id};this.comment.text!==e&&this.$store.dispatch("commentEdit",t),this.isEditable=!1},cancelEdit(){this.message=this.comment.text,this.isEditable=!1},deleteComment(){(0,Ce.L)("comment",(()=>{this.$store.dispatch("commentRemove",this.comment._id)}))}},computed:{...(0,k.Se)(["getUserData","isAuth","getComments"]),showReply(){return this.isChildShown},date(){return(0,C.pJ)(this.comment.dateCreated)},isMyComment(){return!!(this.comment&&this.getUserData&&this.getUserData._id)&&this.getUserData._id===this.comment.commentedBy},hasChildren(){return this.comment.children&&this.comment.children.length}}};const xe=(0,L.Z)(ke,[["render",pe]]);var qe=xe;function De(e){let t=JSON.parse(JSON.stringify(e)),o={},i=[];for(let s=0;s<t.length;s++)o[t[s]._id]=s,t[s].children=[];for(let s=0;s<t.length;s++){let e=t[s];null!==e.followedCommentID&&void 0!==e.followedCommentID?t[o[e.followedCommentID]]&&t[o[e.followedCommentID]].children.push(e):i.push(e)}return i}z()(ke,"components",{QCardSection:U.Z,QAvatar:j.Z,QIcon:A.Z,QBtn:Z.Z,QInput:W.Z});var Fe={name:"CommentBlock",components:{CommentCard:qe,AddComment:ye},props:{showAllComments:{type:Boolean,default:()=>!1}},data(){return{isLoading:!0,post:{}}},async mounted(){try{this.isLoading=!0;const e=await this.$store.dispatch("fetchDetailsPost",this.$route.params.id);this.post=e.data,await this.$store.dispatch("fetchComments",this.$route.params.id)}finally{this.isLoading=!1}},computed:{...(0,k.Se)(["getComments","isAuth"]),createCommentsTree(){return De(this.getComments)}}};const Ve=(0,L.Z)(Fe,[["render",M]]);var $e=Ve,Le={name:"PostDetailsView",components:{PostDetails:P,CommentBlock:$e},data(){return{isLoading:!0,post:{},showAllComments:!1,isEditing:!1}},async mounted(){try{this.isLoading=!0,await this.$store.dispatch("fetchDetailsPost",this.$route.params.id),this.isLoading=!1}catch(e){this.$router.push({name:"NotFound"})}},computed:{...(0,k.Se)(["getComments","getDetailsPost"])}};const Se=(0,L.Z)(Le,[["render",s],["__scopeId","data-v-50a9bd14"]]);var Ze=Se}}]);
//# sourceMappingURL=339.47485dc8.js.map